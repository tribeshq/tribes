// Code generated by internal/config/generate.
// DO NOT EDIT.
//

package configs

import (
	"fmt"

	"github.com/spf13/viper"
)

var ErrNotDefined = fmt.Errorf("variable not defined")

func init() {
	// Automatically bind environment variables.
	viper.AutomaticEnv()
}

const (
	ADMIN_ADDRESS              = "ADMIN_ADDRESS"
	ADMIN_ADDRESS_TEST         = "ADMIN_ADDRESS_TEST"
	BADGE_FACTORY_ADDRESS      = "BADGE_FACTORY_ADDRESS"
	EMERGENCY_WITHDRAW_ADDRESS = "EMERGENCY_WITHDRAW_ADDRESS"
	SAFE_ERC1155_MINT_ADDRESS  = "SAFE_ERC1155_MINT_ADDRESS"
	VERIFIER_ADDRESS           = "VERIFIER_ADDRESS"
	VERIFIER_ADDRESS_TEST      = "VERIFIER_ADDRESS_TEST"
	DATABASE_URL               = "DATABASE_URL"
	ISSUANCE_FEE               = "ISSUANCE_FEE"
	MAX_STARTUP_TIME           = "MAX_STARTUP_TIME"
)

func SetDefaults() {
	// Set defaults based on the TOML definitions.

	viper.SetDefault(ADMIN_ADDRESS, "0xD554153658E8D466428Fa48487f5aba18dF5E628")

	viper.SetDefault(ADMIN_ADDRESS_TEST, "0x976EA74026E726554dB657fA54763abd0C3a0aa9")

	viper.SetDefault(BADGE_FACTORY_ADDRESS, "0x0000000000000000000000000000000000000013")

	viper.SetDefault(EMERGENCY_WITHDRAW_ADDRESS, "0x0000000000000000000000000000000000000006")

	viper.SetDefault(SAFE_ERC1155_MINT_ADDRESS, "0x0000000000000000000000000000000000000007")

	viper.SetDefault(VERIFIER_ADDRESS, "0xc2D8eb4a934AEc7268E414a3Fa3D20E0572d714b")

	viper.SetDefault(VERIFIER_ADDRESS_TEST, "0x0000000000000000000000000000000000000025")

	viper.SetDefault(DATABASE_URL, "sqlite:///mnt/data/rollup.db")

	viper.SetDefault(ISSUANCE_FEE, "500")

	viper.SetDefault(MAX_STARTUP_TIME, "10")

}

// RollupConfig holds configuration values for the rollup service.
type RollupConfig struct {

	// Address of the admin user
	AdminAddress Address `mapstructure:"ADMIN_ADDRESS"`

	// Address of the admin user
	AdminAddressTest Address `mapstructure:"ADMIN_ADDRESS_TEST"`

	// Address of the badge factory contract, who can deploy the badges
	BadgeFactoryAddress Address `mapstructure:"BADGE_FACTORY_ADDRESS"`

	// Address of the emergency withdraw address
	EmergencyWithdrawAddress Address `mapstructure:"EMERGENCY_WITHDRAW_ADDRESS"`

	// Address of the safe ERC1155 mint address
	SafeErc1155MintAddress Address `mapstructure:"SAFE_ERC1155_MINT_ADDRESS"`

	// Address of the verifier contract, who can verify the social accounts
	VerifierAddress Address `mapstructure:"VERIFIER_ADDRESS"`

	// Address of the verifier contract, who can verify the social accounts
	VerifierAddressTest Address `mapstructure:"VERIFIER_ADDRESS_TEST"`

	// SQLite database connection string
	DatabaseUrl string `mapstructure:"DATABASE_URL"`

	// Issuance fee in basis points (e.g., 500 = 5%, 250 = 2.5%, 1000 = 10%)
	IssuanceFee uint64 `mapstructure:"ISSUANCE_FEE"`

	// Maximum startup time for the rollup service
	MaxStartupTime Duration `mapstructure:"MAX_STARTUP_TIME"`
}

// LoadRollupConfig reads configuration from environment variables, a config file, and defaults.
// Priority: command line flags > environment variables > config file > defaults.
func LoadRollupConfig() (*RollupConfig, error) {
	SetDefaults()

	// Load config file if specified via --config flag.
	if cfgFile := viper.GetString("config"); cfgFile != "" {
		viper.SetConfigFile(cfgFile)
		if err := viper.ReadInConfig(); err != nil {
			return nil, fmt.Errorf("error reading config file: %w", err)
		}
	}

	var cfg RollupConfig
	var err error

	cfg.AdminAddress, err = GetAdminAddress()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get ADMIN_ADDRESS: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("ADMIN_ADDRESS is required for the rollup service: %w", err)
	}

	cfg.AdminAddressTest, err = GetAdminAddressTest()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get ADMIN_ADDRESS_TEST: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("ADMIN_ADDRESS_TEST is required for the rollup service: %w", err)
	}

	cfg.BadgeFactoryAddress, err = GetBadgeFactoryAddress()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get BADGE_FACTORY_ADDRESS: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("BADGE_FACTORY_ADDRESS is required for the rollup service: %w", err)
	}

	cfg.EmergencyWithdrawAddress, err = GetEmergencyWithdrawAddress()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get EMERGENCY_WITHDRAW_ADDRESS: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("EMERGENCY_WITHDRAW_ADDRESS is required for the rollup service: %w", err)
	}

	cfg.SafeErc1155MintAddress, err = GetSafeErc1155MintAddress()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get SAFE_ERC1155_MINT_ADDRESS: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("SAFE_ERC1155_MINT_ADDRESS is required for the rollup service: %w", err)
	}

	cfg.VerifierAddress, err = GetVerifierAddress()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get VERIFIER_ADDRESS: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("VERIFIER_ADDRESS is required for the rollup service: %w", err)
	}

	cfg.VerifierAddressTest, err = GetVerifierAddressTest()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get VERIFIER_ADDRESS_TEST: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("VERIFIER_ADDRESS_TEST is required for the rollup service: %w", err)
	}

	cfg.DatabaseUrl, err = GetDatabaseUrl()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get DATABASE_URL: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("DATABASE_URL is required for the rollup service: %w", err)
	}

	cfg.IssuanceFee, err = GetIssuanceFee()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get ISSUANCE_FEE: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("ISSUANCE_FEE is required for the rollup service: %w", err)
	}

	cfg.MaxStartupTime, err = GetMaxStartupTime()
	if err != nil && err != ErrNotDefined {
		return nil, fmt.Errorf("failed to get MAX_STARTUP_TIME: %w", err)
	} else if err == ErrNotDefined {
		return nil, fmt.Errorf("MAX_STARTUP_TIME is required for the rollup service: %w", err)
	}

	return &cfg, nil
}

// GetAdminAddress returns the value for the environment variable ADMIN_ADDRESS.
func GetAdminAddress() (Address, error) {
	s := viper.GetString(ADMIN_ADDRESS)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", ADMIN_ADDRESS, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", ADMIN_ADDRESS, ErrNotDefined)
}

// GetAdminAddressTest returns the value for the environment variable ADMIN_ADDRESS_TEST.
func GetAdminAddressTest() (Address, error) {
	s := viper.GetString(ADMIN_ADDRESS_TEST)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", ADMIN_ADDRESS_TEST, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", ADMIN_ADDRESS_TEST, ErrNotDefined)
}

// GetBadgeFactoryAddress returns the value for the environment variable BADGE_FACTORY_ADDRESS.
func GetBadgeFactoryAddress() (Address, error) {
	s := viper.GetString(BADGE_FACTORY_ADDRESS)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", BADGE_FACTORY_ADDRESS, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", BADGE_FACTORY_ADDRESS, ErrNotDefined)
}

// GetEmergencyWithdrawAddress returns the value for the environment variable EMERGENCY_WITHDRAW_ADDRESS.
func GetEmergencyWithdrawAddress() (Address, error) {
	s := viper.GetString(EMERGENCY_WITHDRAW_ADDRESS)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", EMERGENCY_WITHDRAW_ADDRESS, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", EMERGENCY_WITHDRAW_ADDRESS, ErrNotDefined)
}

// GetSafeErc1155MintAddress returns the value for the environment variable SAFE_ERC1155_MINT_ADDRESS.
func GetSafeErc1155MintAddress() (Address, error) {
	s := viper.GetString(SAFE_ERC1155_MINT_ADDRESS)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", SAFE_ERC1155_MINT_ADDRESS, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", SAFE_ERC1155_MINT_ADDRESS, ErrNotDefined)
}

// GetVerifierAddress returns the value for the environment variable VERIFIER_ADDRESS.
func GetVerifierAddress() (Address, error) {
	s := viper.GetString(VERIFIER_ADDRESS)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", VERIFIER_ADDRESS, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", VERIFIER_ADDRESS, ErrNotDefined)
}

// GetVerifierAddressTest returns the value for the environment variable VERIFIER_ADDRESS_TEST.
func GetVerifierAddressTest() (Address, error) {
	s := viper.GetString(VERIFIER_ADDRESS_TEST)
	if s != "" {
		v, err := toAddress(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", VERIFIER_ADDRESS_TEST, err)
		}
		return v, nil
	}
	return notDefinedAddress(), fmt.Errorf("%s: %w", VERIFIER_ADDRESS_TEST, ErrNotDefined)
}

// GetDatabaseUrl returns the value for the environment variable DATABASE_URL.
func GetDatabaseUrl() (string, error) {
	s := viper.GetString(DATABASE_URL)
	if s != "" {
		v, err := toString(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", DATABASE_URL, err)
		}
		return v, nil
	}
	return notDefinedstring(), fmt.Errorf("%s: %w", DATABASE_URL, ErrNotDefined)
}

// GetIssuanceFee returns the value for the environment variable ISSUANCE_FEE.
func GetIssuanceFee() (uint64, error) {
	s := viper.GetString(ISSUANCE_FEE)
	if s != "" {
		v, err := toUint64(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", ISSUANCE_FEE, err)
		}
		return v, nil
	}
	return notDefineduint64(), fmt.Errorf("%s: %w", ISSUANCE_FEE, ErrNotDefined)
}

// GetMaxStartupTime returns the value for the environment variable MAX_STARTUP_TIME.
func GetMaxStartupTime() (Duration, error) {
	s := viper.GetString(MAX_STARTUP_TIME)
	if s != "" {
		v, err := toDuration(s)
		if err != nil {
			return v, fmt.Errorf("failed to parse %s: %w", MAX_STARTUP_TIME, err)
		}
		return v, nil
	}
	return notDefinedDuration(), fmt.Errorf("%s: %w", MAX_STARTUP_TIME, ErrNotDefined)
}
